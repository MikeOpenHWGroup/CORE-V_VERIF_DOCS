

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CORE-V Formal Verification &mdash; CORE-V Verification Strategy  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CORE-V FPGA Prototyping" href="fpga.html" />
    <link rel="prev" title="Simulation Tests in the UVM Environments" href="sim_tests.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #DDDDDD" >
          

          
            <a href="index.html" class="icon icon-home"> CORE-V Verification Strategy
          

          
            
            <img src="_static/openhw-landscape.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning_requirements.html">Verification Planning and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="pulp_verif.html">PULP-Platform Simulation Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv32_env.html">CV32E40P Simulation Testbench and Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv64_env.html">CV64A Simulation Testbench and Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim_tests.html">Simulation Tests in the UVM Environments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CORE-V Formal Verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#formal-core-v-isa-specifications">Formal CORE-V ISA Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-of-sail-models-in-core-v-verification">Use of Sail Models in CORE-V Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#development-of-sail-models-for-core-v-cores">Development of Sail Models for CORE-V Cores</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#work-items">Work Items</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specifications">Specifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-and-tool-resources">Compute and Tool Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formal-testplans">Formal Testplans</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formal-testbenches">Formal Testbenches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#formal-verification-workflow">Formal Verification Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fpga.html">CORE-V FPGA Prototyping</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CORE-V Verification Strategy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>CORE-V Formal Verification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/formal.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core-v-formal-verification">
<h1>CORE-V Formal Verification<a class="headerlink" href="#core-v-formal-verification" title="Permalink to this headline">¶</a></h1>
<p>Formal verification of the CV32E and CV64A cores is a joint effort of
the OpenHW Group and OneSpin Solutions with the support of multiple
Active Contributors (AC) from other OpenHW Group member companies. This
section specifies the goals, work items, workflow and expected outcomes
of CV32E and CV64A formal verification.</p>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>Completeness of formal verification is measured in a way similar to
simulation verification. That is, a Verification Plan (Testplan) will be
captured that specifies all features of the cores, and assertions will
be either automatically generated or manually written to cover all items
of the plan. Formal verification is said to be complete when proofs for
all assertions have been run and passed. Code coverage and/or
cone-of-influence coverage will be reviewed to ensure that all logic is
properly covered by at least one assertion in the formal testbench.</p>
<p>Note that proofs may be either bounded or unbounded. Where it is not
practical to achieve an unbounded proof a human analysis is performed to
determine the minimum proof depth required to sign off the assertion in
question. For these bounded proofs, the assertion is considered covered
when the required proof depth has been achieved without detecting a
counterexample (failure).</p>
</div>
<div class="section" id="formal-core-v-isa-specifications">
<h2>Formal CORE-V ISA Specifications<a class="headerlink" href="#formal-core-v-isa-specifications" title="Permalink to this headline">¶</a></h2>
<p>It is believed that the RISC-V Foundation has plans to create formal,
machine readable, versions of the RISC-V ISA and that the implementation
language for this machine readable ISA is
<a class="reference external" href="https://www.cl.cam.ac.uk/~pes20/sail/">Sail</a>. Once complete and
ratified, the formal model(s) will be <em>the</em> ISA and the human language
versions of the ISA will be demoted to reference documents. ToDo: find a
reference to confirm this.</p>
<p>Sail is a product of the
<a class="reference external" href="https://www.cl.cam.ac.uk/~pes20/rems/index.html">REMS</a> group, an
academic group in the UK, which has also created partial Sail models of
the RV32IMAC and RV64IMAC ISAs. These model are maintained in GitHub at
<a class="reference external" href="https://github.com/rems-project/sail-riscv">https://github.com/rems-project/sail-riscv</a> and the project is in active
development.</p>
<div class="section" id="use-of-sail-models-in-core-v-verification">
<h3>Use of Sail Models in CORE-V Verification<a class="headerlink" href="#use-of-sail-models-in-core-v-verification" title="Permalink to this headline">¶</a></h3>
<p>Three considerations are driving the OpenHW Group’s interest in formal
ISA (Sail) models:</p>
<ul class="simple">
<li>Assuming the RISC-V Foundation develops and supports complete ISA
specification in Sail, the RISC-V community may expect the same of
OpenHW. Developing, maintaining and supporting formal specifications
of the CORE-V ISAs will lend credibility to the CORE-V family.</li>
<li>A formal model of the ISA supports the creation of a tool-flow that
can produce “correct-by-construction” software emulators, compilers,
compliance tests and reference models. This capability will generate
interest in CORE-V IP from both Industry and Academia.</li>
<li>The primary interest in Sail is the** possibility of using a Sail
model as a reference model for the formal testbench assertions.** The
assertions will verify that a certain micro-architecture implements
the ISA from the Sail spec. Essentially, the assertions together with
the OneSpin GapFree technology perform an equivalence check between
Sail model and the RTL to ensure that:<ul>
<li>everything behaves according to the ISA (Sail model),</li>
<li>nothing on top of what is specified in the ISA (Sail model) is
implemented in the RTL.</li>
</ul>
</li>
</ul>
<p>OneSpin is currently investigating how to best make use of the Sail
model. This will be captured in a future release of this document.</p>
</div>
<div class="section" id="development-of-sail-models-for-core-v-cores">
<h3>Development of Sail Models for CORE-V Cores<a class="headerlink" href="#development-of-sail-models-for-core-v-cores" title="Permalink to this headline">¶</a></h3>
<p>At the time of this writing <a class="footnote-reference" href="#id3" id="id1">[15]</a>, the completeness of the RV32/64IMAC
Sail models is not known, but is believed to be complete. Extensions of
the models will be required to support Zifencei, Zicsr, Counters and the
XPULP extensions. OpenHW may also wish to include User Mode and PMP
support as well, especially for the CV64A. Its a given that much or all
of the work to create these extensions to the Sail models will need to
be done by the OpenHW Group.</p>
<p>Given that CV32E and CV64A projects are leveraging pre-existing
specifications and models, it should be possible for the
micro-architecture and Sail models to be developed in parallel and by
different ACs.</p>
</div>
</div>
<div class="section" id="work-items">
<h2>Work Items<a class="headerlink" href="#work-items" title="Permalink to this headline">¶</a></h2>
<p>This sub-section details a set of work items (or deliverables) to be
produced by either the OpenHW Group and/or OneSpin Solutions. Note that
deliverables assigned to OpenHW may be produced solely or jointly by an
employee or contractor of the OpenHW Group, or by an Active Contributor
(AC) provided by another member company.</p>
<p>Table 2: CORE-V Formal Verification Work Items</p>
<table border="1" class="docutils">
<colgroup>
<col width="2%" />
<col width="32%" />
<col width="8%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">#</th>
<th class="head">Work Items</th>
<th class="head">Provided By</th>
<th class="head">Comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Micro-architecture Specifications (one per core)</td>
<td>OpenHW Group</td>
<td>Based on design documentation developed by PULP-Platform</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>ISA Sail Models (one per core)</td>
<td>OpenHW Group</td>
<td>Based on the RV64IMAC Sail model developed by the RISC-V Foundation</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Define the use of Sail ISA specification/model in a formal verification flow.</td>
<td>OneSpin Solutions</td>
<td>OneSpin is currently investigating how to best make use of the Sail model. See Section <a class="reference external" href="#anchor-14">7.2</a> for a discussion of this topic.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>Compute Infrastructure</td>
<td>OpenHW Group</td>
<td>OpenHW will create one or more VMs on the IBM Cloud to support formal verification of both Cores.</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Tool Licenses</td>
<td>OneSpin Solutions</td>
<td>OneSpin provides tool licenses in sufficient numbers to allow for “reasonable” regression turn-around time.</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>Formal Testplans (one per core)</td>
<td>OpenHW Group and
OneSpin Solutions</td>
<td>ToDo: work with OneSpin to define template.</td>
</tr>
<tr class="row-even"><td>7</td>
<td>Formal Testbenches (one per core)</td>
<td>OneSpin Solutions</td>
<td>OneSpin is not responsible for the complete formal testbench, see sub-section <a class="reference external" href="#anchor-15">7.3.4</a>.</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>Formal Verification of Cores</td>
<td>OpenHW Group and
OneSpin Solutions</td>
<td>See the sub-section <a class="reference external" href="#anchor-16">7.4</a>.</td>
</tr>
</tbody>
</table>
<div class="section" id="specifications">
<h3>Specifications<a class="headerlink" href="#specifications" title="Permalink to this headline">¶</a></h3>
<p>See rows #1 and #2 in , above. The first step of the process is for the
OpenHW Group to develop and deliver:</p>
<ul class="simple">
<li><strong>Micro-architecture specifications</strong> for both cores. This activity
has started and is proceeding under the direction of Davide
Schiavone, Director of Engineering for the Cores Task Group.</li>
<li><strong>Sail models</strong> of each core’s ISA. This activity will be managed by
the Verification Task Group. The expectation is that this
pre-existing Sail model can be extended for both the CV32E and CV64A
cores, including the PULP ISA extensions.</li>
</ul>
</div>
<div class="section" id="compute-and-tool-resources">
<h3>Compute and Tool Resources<a class="headerlink" href="#compute-and-tool-resources" title="Permalink to this headline">¶</a></h3>
<p>This is rows #4 and #5 in , above. Tool licenses in sufficient numbers
to allow for “reasonable” regression turn-around time on CV64A RTL.
These tools will be installed on VMs on the IBM Cloud and will only be
accessible by employees/contractors of the OpenHW Group or select ACs
actively involved in formal verification work.</p>
</div>
<div class="section" id="formal-testplans">
<h3>Formal Testplans<a class="headerlink" href="#formal-testplans" title="Permalink to this headline">¶</a></h3>
<p>OpenHW and OneSpin will jointly develop Formal Testplans for both the
CV32E and CV64A. The high-level goals of the FTBs will be two-fold:</p>
<ol class="arabic simple">
<li>Prove that the core designs conform to the RISC-V+Pulp-extended ISA.
Specifically, every instruction must:</li>
</ol>
<ul class="simple">
<li><ul class="first">
<li>decode properly</li>
<li>perform the correct function</li>
<li>complete as specified (location of results, condition flag
settings, etc.)</li>
</ul>
</li>
</ul>
<p>In particular, the above must be true in the presence or absence of
exceptions, interrupts or debug commands.</p>
<ol class="arabic simple" start="2">
<li>Prove the logical correctness of the implementation with respect to
the micro-architecture (note that not all of these features are
support by every CORE-V core):</li>
</ol>
<ul class="simple">
<li><ul class="first">
<li>Interface logic</li>
<li>Pipeline hazards</li>
<li>Exception handling</li>
<li>Interrupt handling</li>
<li>Debug support</li>
<li>Out of order execution</li>
<li>Speculative execution</li>
<li>Memory management</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="formal-testbenches">
<h3>Formal Testbenches<a class="headerlink" href="#formal-testbenches" title="Permalink to this headline">¶</a></h3>
<p>Conceptually, a formal testbench is a collection of assumptions,
assertions and cover statements. The assumptions provide the necessary
scaffolding logic in order to support the operation of the formal
engines. Examples of these include the identification of clocks, and
resets, constraints on clock and reset cycle timing and input
wire-protocol constraints. Most assertions in the formal testbench exist
to prove one or more items in the Testplan. Covers exist to prove that a
specific function has, in fact, been tested. The formal testbench coding
is considered complete when all assumptions, assertions and covers are
coded.</p>
<p>OneSpin will initiate development of Formal testbenches (FTB) for CV32E
and CV64A as soon as possible. These FTBs will be open-source, ideally
implemented in SystemVerilog, and may be based on OneSpin’s RISC-V
Verification App <a class="footnote-reference" href="#id4" id="id2">[16]</a>.</p>
<p>It is not expected that OneSpin will deliver a complete formal
testbench. Rather, OneSpin will deliver a formal testbench that has two
specific attributes:</p>
<ol class="arabic simple">
<li>Assertions to prove that the core implementation (RTL model) conforms
to the RISC-V+Pulp-extended ISA. The ISA used for this will be the
Sail model (see Section X).</li>
<li>Sufficient assumptions, assertions and covers such that ACs from
other OpenHW member companies are able to read the Testplan and add
the required assumptions, assertions and covers to move the project
towards completion.</li>
</ol>
</div>
</div>
<div class="section" id="formal-verification-workflow">
<h2>Formal Verification Workflow<a class="headerlink" href="#formal-verification-workflow" title="Permalink to this headline">¶</a></h2>
<p>ToDo: add a figure here to illustrate the workflow</p>
<p>The workflow for CORE-V formal verification will be similar to that used
by simulation verification. The three key elements of the workflow are:</p>
<ul class="simple">
<li>A <strong>GitHub</strong> centralized repository.</li>
<li><strong>Distributing</strong> the work across multiple teams in multiple
organizations;</li>
<li><strong>Continuous Integration.</strong> Once the compute environment on the IBM
Cloud is established and OneSpin tools deployed, OneSpin will assist
OpenHW to generate script-ware to support automated checks whenever a
new branch or update is pushed to the central repository. Such check
can pinpoint relatively simple errors without running a lot of
verification. OpenHW would then maintain these scripts. In addition,
there will be scripts for more comprehensive/full regression runs
that OpenHW should maintain after initial delivery (if the file list
for compilation changes due to RTL re-organization, for example, this
needs adaption in the respective compile scripts).</li>
</ul>
<p>The most significant difference between the simulation and formal
verification workflows is that all formal verification will use tools
provided by OneSpin Solutions. OneSpin engineers will run either on
OneSpin’s own compute infrastructure or on the Virtual Machines provided
by IBM and managed by OpenHW. ACs from other member companies will run
on the IBM Cloud and use OneSpin tools.</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[15]</a></td><td>First week of January, 2020.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[16]</a></td><td>OneSpin White paper: Assuring the Integrity of RISC-V Cores and SoCs.
OneSpin Solutions, 2019.</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fpga.html" class="btn btn-neutral float-right" title="CORE-V FPGA Prototyping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sim_tests.html" class="btn btn-neutral float-left" title="Simulation Tests in the UVM Environments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, OpenHW Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>